Menu="UNRAID-OS"
Title="System Log"
---
<?PHP
/* Copyright 2014, Lime Technology
 * Copyright 2014, Bergware International.
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License version 2,
 * as published by the Free Software Foundation.
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 */
?>
<?
echo "<pre class='up'>".shell_exec('cat /var/log/syslog')."</pre>";
?>
<script>
  function uploadLog(button, title, type, text){
    old = $(button).html();
    $(button).html("<i class='fa fa-circle-o-notch fa-spin'></i> Uploading...");
    $.post("/webGui/include/UploadLog.php",{pastebin:'true',title:title,type:type,text:text},function(data){if(data.result != "failed"){window.open(data.result, '_blank')};clearTimeout(timers.notifier);notifier();$(button).html(old);},'json');
  }
  function cleanUp() {
    if (document.hasFocus()) {
      $.post('/webGui/include/Download.php',{cmd:'delete',file:'<?=$docroot?>/syslog.zip'});
    } else {
      setTimeout(cleanUp,4000);
    }
  }  
  function syslog() {
    $.post('/webGui/include/Download.php',{cmd:'save',root:'<?=$docroot?>',file:'/var/log/syslog'},function(data) {
      location = data;
      setTimeout(cleanUp,4000);
    });
  }
  $('.tabs').append("<span class='status vhshift'><input type='button' value='Download' onclick='syslog()'></span>");
  $('.tabs').append("<span class='status vhshift' style='padding-right:15px;'><button type='button' onclick='uploadLog(this, \"Syslog\", \"file\", \"/var/log/syslog\");'><i class='fa fa-upload'></i> Upload Syslog</button></span>");
</script>
<button type="button" onclick="syslog()">Download</button><button type="button" onclick="done()">Done</button>
